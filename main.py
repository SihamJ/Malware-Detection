
from malware_detector import Malware_Detector
import os

DIRECTORY_PATH = '../'
data_path = 'data.csv'
target_classes = {
    'Benign': 'Benign',
    'Malware': {
        'Trojan': {
            'Emotet': 'Emotet',
            'Reconyc': 'Reconyc',
            'Refroso': 'Refroso',
            'Scar': 'Scar',
            'Zeus': 'Zeus',
            'model': ['xgb','random_forest']
        },
        'Spyware': {
            '180solutions': '180solutions',
            'CWS': 'CWS',
            'Gator': 'Gator',
            'TIBS': 'TIBS',
            'Transponder': 'Transponder',
            'model': ['xgb','random_forest']
        },
        'Ransomware': {
            'Ako': 'Ako',
            'Conti': 'Conti',
            'Maze': 'Maze',
            'Pysa': 'Pysa',
            'Shade': 'Shade',
            'model': ['xgb','random_forest']
        },
        'model': ['cart', 'random_forest']
    },
    'model': ['svm']
}

# Create the model
malware_detector = Malware_Detector(path=data_path, target_classes=target_classes, malware_features=['Class', 'malware_cat', 'malware_fam'], classification_level=1, prediction='max')

# Fit the model
malware_detector.fit()

# Classification report on test data: Plot Confusion Matrix + AUPRC
malware_detector.report_()

# Predict on some X, here we retrieve X_test from the class instance
X = malware_detector.get_X_test()
y_pred = malware_detector.is_malware(X)
print(y_pred)